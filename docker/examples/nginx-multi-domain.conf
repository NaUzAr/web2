# =============================================
# NGINX CONFIG: Multi-Domain (3 Web)
# =============================================
# File: /root/shared-services/nginx.conf

# =============================================
# WEB 1: SmartAgri
# =============================================
server {
    listen 80;
    listen [::]:80;
    server_name smartagri.web.id www.smartagri.web.id;  # ← Domain 1
    
    root /var/www/smartagri-iot/public;                  # ← Path 1
    index index.php;
    
    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    location ~ \.php$ {
        fastcgi_pass smartagri-app:9000;                 # ← Container 1
        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
        include fastcgi_params;
    }

    location ~ /\.(?!well-known).* {
        deny all;
    }
}


# =============================================
# WEB 2: Toko Online
# =============================================
server {
    listen 80;
    listen [::]:80;
    server_name tokoonline.com www.tokoonline.com;      # ← Domain 2
    
    root /var/www/tokoonline/public;                     # ← Path 2
    index index.php;
    
    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    location ~ \.php$ {
        fastcgi_pass tokoonline-app:9000;                # ← Container 2
        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
        include fastcgi_params;
    }

    location ~ /\.(?!well-known).* {
        deny all;
    }
}


# =============================================
# WEB 3: Portfolio
# =============================================
server {
    listen 80;
    listen [::]:80;
    server_name portfolio.me www.portfolio.me;          # ← Domain 3
    
    root /var/www/portfolio/public;                      # ← Path 3
    index index.php;
    
    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    location ~ \.php$ {
        fastcgi_pass portfolio-app:9000;                 # ← Container 3
        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
        include fastcgi_params;
    }

    location ~ /\.(?!well-known).* {
        deny all;
    }
}
