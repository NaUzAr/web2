# =============================================
# WEB 2: Toko Online (tokoonline.com)
# =============================================
# Folder: /root/tokoonline/

version: '2.4'

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    image: tokoonline-app              # ← BEDA: Nama image
    container_name: tokoonline-app     # ← BEDA: Nama container
    restart: unless-stopped
    volumes:
      - .:/var/www
      - tokoonline_vendor:/var/www/vendor      # ← BEDA: Volume
      - tokoonline_storage:/var/www/storage
    networks:
      - smartagri-network              # ← SAMA: Network shared
    environment:
      - DB_CONNECTION=pgsql
      - DB_HOST=shared-db              # ← SAMA: DB host
      - DB_PORT=5432
      - DB_DATABASE=tokoonline_db      # ← BEDA: Database
      - DB_USERNAME=tokoonline_user    # ← BEDA: User
      - DB_PASSWORD=tokoonline_secret  # ← BEDA: Password
      - APP_URL=https://tokoonline.com

networks:
  smartagri-network:
    external: true                     # ← Connect ke network existing

volumes:
  tokoonline_vendor:    # ← BEDA: Volume
  tokoonline_storage:
