# =============================================
# WEB 1: SmartAgri (smartagri.web.id)
# =============================================
# Folder: /root/smartagri-iot/

version: '2.4'

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    image: smartagri-app              # ← Nama image
    container_name: smartagri-app     # ← Nama container
    restart: unless-stopped
    volumes:
      - .:/var/www
      - smartagri_vendor:/var/www/vendor      # ← Volume unik
      - smartagri_storage:/var/www/storage
    networks:
      - smartagri-network
    environment:
      - DB_CONNECTION=pgsql
      - DB_HOST=shared-db
      - DB_PORT=5432
      - DB_DATABASE=smartagri_db        # ← Database unik
      - DB_USERNAME=smartagri_user      # ← User unik
      - DB_PASSWORD=smartagri_secret    # ← Password unik
      - APP_URL=https://smartagri.web.id

networks:
  smartagri-network:
    external: true

volumes:
  smartagri_vendor:     # ← Volume unik
  smartagri_storage:
