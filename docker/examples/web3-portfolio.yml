# =============================================
# WEB 3: Portfolio (portfolio.me)
# =============================================
# Folder: /root/portfolio/

version: '2.4'

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    image: portfolio-app               # ← BEDA: Nama image
    container_name: portfolio-app      # ← BEDA: Nama container
    restart: unless-stopped
    volumes:
      - .:/var/www
      - portfolio_vendor:/var/www/vendor       # ← BEDA: Volume
      - portfolio_storage:/var/www/storage
    networks:
      - smartagri-network              # ← SAMA: Network shared
    environment:
      - DB_CONNECTION=pgsql
      - DB_HOST=shared-db              # ← SAMA: DB host
      - DB_PORT=5432
      - DB_DATABASE=portfolio_db       # ← BEDA: Database
      - DB_USERNAME=portfolio_user     # ← BEDA: User
      - DB_PASSWORD=portfolio_secret   # ← BEDA: Password
      - APP_URL=https://portfolio.me

networks:
  smartagri-network:
    external: true                     # ← Connect ke network existing

volumes:
  portfolio_vendor:     # ← BEDA: Volume
  portfolio_storage:
